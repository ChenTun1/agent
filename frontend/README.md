# AI PDF Chat - Frontend

Streamlitå‰ç«¯åº”ç”¨,æä¾›PDFä¸Šä¼ å’ŒèŠå¤©äº¤äº’ç•Œé¢ã€‚

## åŠŸèƒ½ç‰¹æ€§

- ğŸ“ **PDFä¸Šä¼ **: æ”¯æŒæ‹–æ‹½ä¸Šä¼ ,è‡ªåŠ¨å¤„ç†PDFæ–‡ä»¶
- ğŸ’¬ **èŠå¤©ç•Œé¢**: æµç•…çš„å¯¹è¯ä½“éªŒ,ç±»ä¼¼ChatGPT
- ğŸ“ **æ¥æºæ˜¾ç¤º**: æ¯ä¸ªå›ç­”éƒ½æ ‡æ³¨æ¥æºé¡µç å’ŒåŸæ–‡
- ğŸ’¡ **æ™ºèƒ½æ¨è**: æ ¹æ®æ–‡æ¡£ç±»å‹æ¨èç›¸å…³é—®é¢˜
- ğŸ‘ğŸ‘ **ç”¨æˆ·åé¦ˆ**: æ”¶é›†ç”¨æˆ·å¯¹ç­”æ¡ˆè´¨é‡çš„åé¦ˆ
- ğŸ”„ **å¯¹è¯å†å²**: ä¿æŒå®Œæ•´çš„å¯¹è¯ä¸Šä¸‹æ–‡

## æ–‡ä»¶ç»“æ„

```
frontend/
â”œâ”€â”€ __init__.py       # PythonåŒ…åˆå§‹åŒ–æ–‡ä»¶
â”œâ”€â”€ app.py            # ä¸»åº”ç”¨å…¥å£,åŒ…å«UIé€»è¾‘
â”œâ”€â”€ utils.py          # å·¥å…·å‡½æ•°(éªŒè¯ã€æ ¼å¼åŒ–ç­‰)
â””â”€â”€ README.md         # æœ¬æ–‡æ¡£
```

## è¿è¡Œæ–¹æ³•

### å‰ç½®æ¡ä»¶

1. ç¡®ä¿åç«¯APIå·²å¯åŠ¨ (é»˜è®¤: http://localhost:8000)
2. å®‰è£…ä¾èµ–åŒ…:
   ```bash
   pip install -r ../requirements.txt
   ```

### å¯åŠ¨åº”ç”¨

ä»é¡¹ç›®æ ¹ç›®å½•è¿è¡Œ:

```bash
streamlit run frontend/app.py
```

åº”ç”¨å°†åœ¨æµè§ˆå™¨ä¸­è‡ªåŠ¨æ‰“å¼€,é»˜è®¤åœ°å€: http://localhost:8501

### ç¯å¢ƒå˜é‡

- `BACKEND_URL`: åç«¯APIåœ°å€ (é»˜è®¤: http://localhost:8000)

è®¾ç½®ç¤ºä¾‹:
```bash
export BACKEND_URL=http://api.example.com
streamlit run frontend/app.py
```

## ä½¿ç”¨æµç¨‹

1. **ä¸Šä¼ PDF**
   - ç‚¹å‡»å·¦ä¾§è¾¹æ çš„æ–‡ä»¶ä¸Šä¼ å™¨
   - é€‰æ‹©PDFæ–‡ä»¶(æœ€å¤§10MB)
   - ç­‰å¾…å¤„ç†å®Œæˆ

2. **æé—®**
   - é¦–æ¬¡ä¸Šä¼ ä¼šæ˜¾ç¤ºæ¨èé—®é¢˜,å¯ç‚¹å‡»å¿«é€Ÿæé—®
   - æˆ–åœ¨åº•éƒ¨è¾“å…¥æ¡†è¾“å…¥è‡ªå®šä¹‰é—®é¢˜
   - ç­‰å¾…AIå›ç­”

3. **æŸ¥çœ‹æ¥æº**
   - ç‚¹å‡»"ğŸ“ View sources"å±•å¼€æŸ¥çœ‹å¼•ç”¨çš„åŸæ–‡
   - æ¯ä¸ªæ¥æºéƒ½æ ‡æ³¨äº†é¡µç 

4. **åé¦ˆ**
   - å¯¹å›ç­”è´¨é‡ç‚¹å‡»ğŸ‘æˆ–ğŸ‘
   - å¸®åŠ©æˆ‘ä»¬æ”¹è¿›ç³»ç»Ÿ

## ä¸»è¦ç»„ä»¶

### app.py

- `main()`: åº”ç”¨ä¸»å…¥å£
- `show_welcome()`: æ¬¢è¿é¡µé¢
- `process_pdf()`: å¤„ç†PDFä¸Šä¼ 
- `chat_interface()`: èŠå¤©ç•Œé¢ä¸»é€»è¾‘
- `ask_question_internal()`: å¤„ç†ç”¨æˆ·æé—®
- `get_answer()`: è°ƒç”¨åç«¯APIè·å–ç­”æ¡ˆ
- `send_feedback()`: å‘é€ç”¨æˆ·åé¦ˆ

### utils.py

- `validate_pdf_file()`: éªŒè¯ä¸Šä¼ çš„PDFæ–‡ä»¶
- `format_source_citation()`: æ ¼å¼åŒ–æ¥æºå¼•ç”¨
- `display_sources()`: æ˜¾ç¤ºæ¥æºåˆ—è¡¨
- `init_session_state()`: åˆå§‹åŒ–ä¼šè¯çŠ¶æ€
- `get_suggested_questions()`: è·å–æ¨èé—®é¢˜
- `extract_page_numbers()`: æå–æ–‡æœ¬ä¸­çš„é¡µç 

## æŠ€æœ¯æ ˆ

- **Streamlit 1.31.0**: Webç•Œé¢æ¡†æ¶
- **Requests**: HTTPå®¢æˆ·ç«¯,è°ƒç”¨åç«¯API
- **Python 3.11+**: è¿è¡Œç¯å¢ƒ

## APIé›†æˆ

å‰ç«¯é€šè¿‡ä»¥ä¸‹APIä¸åç«¯é€šä¿¡:

### POST /upload
ä¸Šä¼ å¹¶å¤„ç†PDFæ–‡ä»¶

è¯·æ±‚:
```python
files = {"file": (filename, file_data, "application/pdf")}
```

å“åº”:
```json
{
  "status": "success",
  "pdf_id": "uuid",
  "filename": "example.pdf",
  "page_count": 50
}
```

### POST /chat
æé—®å¹¶è·å–ç­”æ¡ˆ

è¯·æ±‚:
```json
{
  "pdf_id": "uuid",
  "question": "è¿™ä»½æ–‡æ¡£çš„ä¸»è¦å†…å®¹æ˜¯ä»€ä¹ˆ?"
}
```

å“åº”:
```json
{
  "answer": "æ ¹æ®ç¬¬1é¡µ...",
  "cited_pages": [1, 2, 5],
  "sources": [
    {"page": 1, "text": "..."},
    {"page": 2, "text": "..."}
  ]
}
```

### POST /feedback
æäº¤ç”¨æˆ·åé¦ˆ

è¯·æ±‚:
```json
{
  "pdf_id": "uuid",
  "question": "...",
  "answer": "...",
  "feedback": "helpful" | "inaccurate"
}
```

## ä¼šè¯çŠ¶æ€ç®¡ç†

ä½¿ç”¨Streamlitçš„session_stateç®¡ç†ä»¥ä¸‹çŠ¶æ€:

- `pdf_id`: å½“å‰PDFçš„å”¯ä¸€æ ‡è¯†
- `filename`: PDFæ–‡ä»¶å
- `page_count`: PDFé¡µæ•°
- `messages`: å¯¹è¯å†å²åˆ—è¡¨

## å¼€å‘å»ºè®®

1. **è°ƒè¯•**: ä½¿ç”¨ `streamlit run frontend/app.py --logger.level=debug`
2. **çƒ­é‡è½½**: ä¿®æ”¹ä»£ç åè‡ªåŠ¨åˆ·æ–°
3. **æ¸…é™¤ç¼“å­˜**: å³ä¸Šè§’èœå• â†’ Clear cache

## å¸¸è§é—®é¢˜

**Q: ä¸Šä¼ PDFå¤±è´¥**
- ç¡®ä¿æ–‡ä»¶å¤§å°<10MB
- ç¡®ä¿æ˜¯æœ‰æ•ˆçš„PDFæ–‡ä»¶
- æ£€æŸ¥åç«¯æœåŠ¡æ˜¯å¦è¿è¡Œ

**Q: æ— æ³•è·å–ç­”æ¡ˆ**
- æ£€æŸ¥BACKEND_URLé…ç½®
- ç¡®è®¤åç«¯APIæ­£å¸¸è¿è¡Œ
- æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°é”™è¯¯ä¿¡æ¯

**Q: åé¦ˆæŒ‰é’®ä¸å·¥ä½œ**
- åé¦ˆåŠŸèƒ½ä¸ºéé˜»å¡,å¤±è´¥ä¸å½±å“ä½¿ç”¨
- æ£€æŸ¥åç«¯/feedbackæ¥å£æ˜¯å¦å®ç°

## ä¸‹ä¸€æ­¥ä¼˜åŒ–

- [ ] æ·»åŠ å¤šè¯­è¨€æ”¯æŒ
- [ ] æ”¯æŒæ‰¹é‡PDFä¸Šä¼ 
- [ ] å¯¼å‡ºå¯¹è¯è®°å½•
- [ ] è‡ªå®šä¹‰ä¸»é¢˜é¢œè‰²
- [ ] è¯­éŸ³è¾“å…¥æ”¯æŒ
