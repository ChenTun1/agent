# Streamlit Frontend 测试检查清单

## 前置准备

- [ ] 安装所有依赖: `pip install -r requirements.txt`
- [ ] 后端服务已启动: `uvicorn backend.main:app --reload`
- [ ] 后端健康检查通过: `curl http://localhost:8000/health`
- [ ] 前端已启动: `streamlit run frontend/app.py`

## 功能测试

### 1. 欢迎页面
- [ ] 打开 http://localhost:8501
- [ ] 显示标题 "📄 AI PDF Chat"
- [ ] 显示副标题 "Stop reading, start asking"
- [ ] 显示三个特性说明
- [ ] 左侧边栏显示上传组件

### 2. PDF上传
- [ ] 点击文件上传器
- [ ] 选择有效PDF文件
- [ ] 显示"Processing PDF..."加载提示
- [ ] 上传成功显示绿色提示
- [ ] 显示文件名和页数
- [ ] 侧边栏显示当前PDF信息

#### 边界情况
- [ ] 上传非PDF文件 → 显示错误提示
- [ ] 上传超过10MB的文件 → 显示大小限制错误
- [ ] 后端不可用 → 显示连接错误

### 3. 推荐问题
- [ ] PDF上传后,显示"💡 Suggested Questions"
- [ ] 显示3个推荐问题
- [ ] 点击任一问题 → 自动提问
- [ ] 问题显示在聊天界面
- [ ] 获取并显示回答

### 4. 聊天交互
- [ ] 底部显示输入框
- [ ] 输入框提示文字: "Ask a question about the PDF"
- [ ] 输入问题并发送
- [ ] 用户消息显示在聊天窗口
- [ ] 显示"Thinking..."加载提示
- [ ] AI回答显示在聊天窗口
- [ ] 消息按时间顺序排列

### 5. 来源显示
- [ ] AI回答下方显示"📍 View sources"
- [ ] 点击展开来源信息
- [ ] 每个来源显示页码
- [ ] 每个来源显示原文片段(最多200字符)
- [ ] 多个来源之间有分隔线
- [ ] 来源可以折叠

### 6. 对话历史
- [ ] 连续提问多个问题
- [ ] 所有历史对话保留在界面
- [ ] 用户消息和AI回答交替显示
- [ ] 每条消息的来源都正确保存
- [ ] 滚动查看历史对话

### 7. 用户反馈
- [ ] AI回答下方显示👍和👎按钮
- [ ] 点击👍 → 显示"Thanks!"成功提示
- [ ] 点击👎 → 显示"Feedback recorded"警告提示
- [ ] 反馈发送到后端/feedback接口
- [ ] 反馈失败不影响用户使用

### 8. 上传新PDF
- [ ] 侧边栏显示"🔄 Upload New PDF"按钮
- [ ] 点击按钮 → 清空当前会话
- [ ] 返回欢迎页面
- [ ] 可以上传新的PDF文件
- [ ] 历史对话已清除

## 错误处理

### 后端错误
- [ ] 后端返回400错误 → 显示错误信息
- [ ] 后端返回500错误 → 显示友好错误提示
- [ ] 网络超时 → 显示超时提示
- [ ] 后端不可用 → 显示连接失败提示

### 前端错误
- [ ] 无效的PDF文件 → 验证拦截
- [ ] 空问题提交 → 输入框验证
- [ ] Session state异常 → 自动恢复

## 性能测试

- [ ] 上传10MB PDF → 处理时间<30秒
- [ ] 提问 → 响应时间<5秒
- [ ] 界面流畅,无明显卡顿
- [ ] 长对话(>20轮) → 界面性能正常

## UI/UX检查

- [ ] 所有文字清晰可读
- [ ] 按钮样式一致
- [ ] 颜色使用合理(成功=绿色,错误=红色)
- [ ] 加载状态明确
- [ ] 错误提示友好
- [ ] 移动端显示正常(可选)

## 兼容性测试

浏览器测试:
- [ ] Chrome/Edge (推荐)
- [ ] Firefox
- [ ] Safari

屏幕尺寸:
- [ ] 桌面 (1920x1080)
- [ ] 笔记本 (1366x768)
- [ ] 平板 (可选)

## 集成测试

- [ ] 与FastAPI后端正常通信
- [ ] /upload接口集成正常
- [ ] /chat接口集成正常
- [ ] /feedback接口集成正常
- [ ] 错误格式处理正确

## 安全检查

- [ ] 文件类型验证
- [ ] 文件大小限制
- [ ] 没有XSS漏洞(用户输入正确转义)
- [ ] API调用有超时设置
- [ ] 敏感信息不暴露在前端

## 文档检查

- [ ] README.md完整准确
- [ ] 代码注释清晰
- [ ] API集成说明正确
- [ ] 运行步骤可执行
- [ ] 常见问题有帮助

## 测试结果

**测试日期**: ___________
**测试人员**: ___________
**通过项**: _____ / _____
**失败项**: _____ (列出具体问题)

### 已知问题

1.
2.
3.

### 改进建议

1.
2.
3.

---

## 快速测试脚本

```bash
# 1. 启动后端
cd /Users/mlamp/Desktop/agent
uvicorn backend.main:app --reload &

# 2. 等待后端启动
sleep 5

# 3. 健康检查
curl http://localhost:8000/health

# 4. 启动前端
streamlit run frontend/app.py

# 或使用快捷脚本
./run_frontend.sh
```

## 测试用例示例

### 测试用例1: 基本问答流程

1. 上传PDF: `tests/fixtures/sample.pdf`
2. 问题: "这份文档的主要内容是什么?"
3. 验证:
   - 获得回答
   - 回答包含页码引用
   - 来源显示正确

### 测试用例2: 错误处理

1. 上传非PDF文件
2. 验证: 显示错误提示,不调用后端

### 测试用例3: 多轮对话

1. 上传PDF
2. 连续提问5个不同问题
3. 验证: 所有对话保留,来源正确

---

**签名**: ___________________
**日期**: ___________________
